# FlaClientMock

一个用于**模拟最多16个客户端**同时连接中控服务器并提交测量任务的 Console 程序（.NET 8）。

## 运行
```bash
# 需要 .NET 8 SDK
cd FlaClientMock
# 示例: 连接本机 5600 端口, 16 个客户端, 每个提交 2 个任务, 模式为 scan, 启动错峰 100ms
dotnet run -- 127.0.0.1 5600 16 2 scan 100

# 示例: 8 个客户端, 每个提交 5 个任务, 自动寻峰模式
dotnet run -- 127.0.0.1 5600 8 5 auto_peak 200
```

参数:
- `host`            服务器地址 (默认 `127.0.0.1`)
- `port`            服务器端口 (默认 `5600`)
- `clients`         客户端数量 (默认 `16`，最大 16)
- `tasksPerClient`  每个客户端提交的任务数 (默认 `2`)
- `mode`            `scan` 或 `auto_peak` (默认 `scan`)
- `staggerMs`       每个客户端启动的错峰毫秒 (默认 `50`)

## 协议
- 采用与你的服务器一致的 **JSON-Lines** 协议：每行一个 JSON 对象，必须包含 `op` 字段。
- 客户端发送 `{"op":"submit", ...}`；服务端会返回 `hello`、`ack`、`status`、`result` 等消息。

## 行为
- 客户端保持长连接，不需要心跳；当服务器返回 `result` 时在控制台打印结果摘要。
- `scan` 模式会随机生成分辨率档位/增益/窗口/中心等参数；
- `auto_peak` 模式会随机生成起止范围/宽度/阈值，并按 `id`/`sn` 区分不同客户端与任务。
```
[C01] <- result peak: pos=13.226m db=-47.820dB sn=SN1A1
```

## 注意
- 请先运行你的中控服务器（如 `FlaQueueServer_FLA`），并确认监听地址与端口。
- 若在同一台机器上测试，使用 `127.0.0.1` 即可；跨机测试请替换为服务器的 IP 地址。
```
```
