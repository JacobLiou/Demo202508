<article class="post-detail">
    <header class="post-header">
        {% if post.category %}
        <a href="{% url 'blog:category_posts' post.category.slug %}" class="post-category-tag spa-link">
            {{ post.category.name }}
        </a>
        {% endif %}
        <h1 class="post-title">{{ post.title }}</h1>
        <div class="post-meta">
            <span class="meta-author">ğŸ‘¤ {{ post.author.username }}</span>
            <span class="meta-date">ğŸ“… {{ post.created_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</span>
            <span class="meta-views">ğŸ‘ {{ post.views }} æ¬¡é˜…è¯»</span>
            <span class="meta-comments">ğŸ’¬ {{ comments.count }} æ¡è¯„è®º</span>
        </div>
    </header>

    {% if post.cover_image %}
    <div class="post-cover-large" style="background-image: url('{{ post.cover_image }}')"></div>
    {% endif %}

    <div class="post-body">
        {{ post.content|linebreaks }}
    </div>

    <footer class="post-footer">
        <div class="post-tags">
            <a href="{% url 'blog:post_list' %}" class="btn btn-secondary spa-link">&larr; è¿”å›åˆ—è¡¨</a>
        </div>
    </footer>
</article>

{% if related_posts %}
<section class="related-posts">
    <h3>ç›¸å…³æ–‡ç« </h3>
    <div class="related-grid">
        {% for related in related_posts %}
        <a href="{% url 'blog:post_detail' related.slug %}" class="related-item spa-link">
            <span class="related-title">{{ related.title }}</span>
            <span class="related-date">{{ related.created_at|date:"mæœˆdæ—¥" }}</span>
        </a>
        {% endfor %}
    </div>
</section>
{% endif %}

<section class="comments-section">
    <h3>è¯„è®º ({{ comments.count }})</h3>

    <form id="comment-form" class="comment-form" data-url="{% url 'blog:add_comment' post.slug %}">
        {% csrf_token %}
        <div class="form-row">
            <div class="form-group">
                <label for="author_name">æ˜µç§° *</label>
                <input type="text" id="author_name" name="author_name" required placeholder="è¯·è¾“å…¥æ˜µç§°">
            </div>
            <div class="form-group">
                <label for="author_email">é‚®ç®±</label>
                <input type="email" id="author_email" name="author_email" placeholder="é€‰å¡«">
            </div>
        </div>
        <div class="form-group">
            <label for="content">è¯„è®ºå†…å®¹ *</label>
            <textarea id="content" name="content" rows="4" required placeholder="å†™ä¸‹ä½ çš„è¯„è®º..."></textarea>
        </div>
        <button type="submit" class="btn btn-primary">å‘è¡¨è¯„è®º</button>
    </form>

    <div id="comments-list" class="comments-list">
        {% include 'blog/partials/comments_list.html' %}
    </div>
</section>